<html>

<head>
    <meta charset="UTF-8">
    <title>Webcam Image Classification using MobileNet</title>
    <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
</head>

<body>
    <h1>Webcam Image classification using MobileNet</h1>
    <p>
        The MobileNet model labeled this as <span id="result">...</span>
        <br />with a confidence of <span id="probability">...</span>.
    </p>
    <video id="video" width="640" height="480" autoplay></video>
    <script>
        // Grab elements, create settings, etc.
        const video = document.getElementById("video");

        // Create a webcam capture
        navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
            video.srcObject = stream;
            video.play();
        });

        const loop = classifier => {
            classifier.classify().then(results => {
                result.innerText = results[0].label;
                probability.innerText = results[0].confidence.toFixed(4);
                loop(classifier); // Call again to create a loop
            });
        };

        // Initialize the Image Classifier method with MobileNet passing the video as the
        // second argument and the getClassification function as the third
        ml5.imageClassifier("MobileNet", video).then(classifier => loop(classifier));
        // ml5.imageClassifier("DarkNet", video).then(classifier => loop(classifier));

        // // Initialize the Image Classifier method with MobileNet
        // const classifier = ml5.imageClassifier('MobileNet', modelLoaded);

        // // When the model is loaded
        // function modelLoaded() {
        //     console.log('Model Loaded!');
        // }

        // // Make a prediction with a selected image
        // classifier.classify(document.getElementById('image'), (err, results) => {
        //     console.log(results);
        // });
    </script>
</body>

</html>